<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ODRF">
<title>Oblique Decision Random Forest for Classification and Regression • ODRF</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Oblique Decision Random Forest for Classification and Regression">
<meta property="og:description" content="ODRF">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ODRF</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Oblique-Decision-Random-Forest.html">Oblique Decision Random Forest for Classification and Regression</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/liuyu-star/ODRF/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Oblique Decision Random Forest for Classification and Regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/liuyu-star/ODRF/blob/HEAD/vignettes/Oblique-Decision-Random-Forest.Rmd" class="external-link"><code>vignettes/Oblique-Decision-Random-Forest.Rmd</code></a></small>
      <div class="d-none name"><code>Oblique-Decision-Random-Forest.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="odrf">ODRF
<a href="https://liuyu-star.github.io/ODRF/" class="external-link"><img src="logo.png" align="right" height="139"></a><a class="anchor" aria-label="anchor" href="#odrf"></a>
</h2>
<!-- badges: start -->
<p><a href="https://CRAN.R-project.org/package=ODRF" class="external-link"><img src="https://www.r-pkg.org/badges/version/ODRF" alt="CRAN status"></a>
<a href="https://github.com/liuyu-star/ODRF/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/liuyu-star/ODRF/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://github.com/liuyu-star/ODRF/actions/workflows/pkgdown.yaml" class="external-link"><img src="https://github.com/liuyu-star/ODRF/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a> <a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a> <!-- badges: end --></p>
<p>ODRF implements the well-known Oblique Decision Tree (ODT) and
ODT-based Random Forest (ODRF), which uses linear combinations of
predictors as partitioning variables for both traditional CART and
Random Forest. A number of modifications have been adopted in the
implementation; some new functions are also provided. <!--
The goal of ODRF is to supplement classical CART and random forests for classification and regression. The use of linear combinations of predictors as splitting variables is one of the important extensions of CART and is known as Oblique Decision Trees (ODT) and ODT-based Random Forests (ODRF).
--></p>
<!--
[![Codecov test coverage](https://codecov.io/gh/liuyu-star/ODRF/branch/main/graph/badge.svg)](https://app.codecov.io/gh/liuyu-star/ODRF?branch=main)
-->
<!--
The ODRF R package allows users to define their own functions to find the projections of at each node, which is essential to the performance of the forests. We also provide a complete comparison and analysis for other ODT and ODRF. You can learn more about them in `vignette("ODRF")`.
-->
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>The ODRF <a href="https://cran.r-project.org/" class="external-link">R package</a> consists
of the following main functions:</p>
<ul>
<li>
<code><a href="../reference/ODT.html">ODT()</a></code> classification and regression using an ODT in
which each node is split by a linear combination of predictors.</li>
<li>
<code><a href="../reference/ODRF.html">ODRF()</a></code> classification and regression implemented by the
ODRF It’s an extension of random forest based on ODT() and includes
random forest as a special case.</li>
<li>
<code>Online()</code> online training to update existing ODT and
ODRF by using new data sets.</li>
<li>
<code><a href="../reference/prune.html">prune()</a></code> prune ODT from bottom to top with validation
data based on prediction error.</li>
<li>
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, predict() and plot() the base R functions in
the base R Package to class ODT and ODRF.</li>
</ul>
<p><code>ODRF</code> allows users to define their own functions to find
the projections at each node, which is essential to the performance of
the forests. We also provide a complete comparison and analysis for
other ODT and ODRF, more details are available in vignette(“ODRF”).</p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the development version of ODRF from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"liuyu-star/ODRF"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p>We show how to use the ODRF package with examples.</p>
<div class="section level4">
<h4 id="classification-and-regression-using-odt-and-odrf">Classification and regression using ODT and ODRF<a class="anchor" aria-label="anchor" href="#classification-and-regression-using-odt-and-odrf"></a>
</h4>
<p>Examples of classification and regression using ODRF and ODT are as
follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://liuyu-star.github.io/ODRF/" class="external-link">ODRF</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: partykit</span></span>
<span><span class="co">#&gt; Loading required package: grid</span></span>
<span><span class="co">#&gt; Loading required package: libcoin</span></span>
<span><span class="co">#&gt; Loading required package: mvtnorm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">seeds</span>, package <span class="op">=</span> <span class="st">"ODRF"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">209</span>, <span class="fl">150</span><span class="op">)</span></span>
<span><span class="va">seeds_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">[</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">seeds_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ODRF.html">ODRF</a></span><span class="op">(</span><span class="va">varieties_of_wheat</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">seeds_train</span>, split <span class="op">=</span> <span class="st">"gini"</span>, </span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest</span>, <span class="va">seeds_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">!=</span> <span class="va">seeds_test</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01694915</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">body_fat</span>, package <span class="op">=</span> <span class="st">"ODRF"</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">252</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">bodyfat_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">body_fat</span><span class="op">[</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">bodyfat_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">body_fat</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ODT.html">ODT</a></span><span class="op">(</span><span class="va">Density</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">bodyfat_train</span>, split <span class="op">=</span> <span class="st">'mse'</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tree</span>, <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred</span> <span class="op">-</span> <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.047499e-05</span></span></code></pre></div>
<p>In the following example, suppose the training data are available in
two batches. The first batch is used to train ODT and ODRF, and the
second batch is used to update the model by online. The error after the
model update is significantly smaller than that of one batch of data
alone.</p>
<p>Update existing ODT and ODRF with online.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">17</span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">seeds_train</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">seeds_train</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">forest1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ODRF.html">ODRF</a></span><span class="op">(</span><span class="va">varieties_of_wheat</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">seeds_train</span><span class="op">[</span><span class="va">index</span>, <span class="op">]</span>,</span>
<span>  split <span class="op">=</span> <span class="st">"gini"</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest1</span>, <span class="va">seeds_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.forest.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">!=</span> <span class="va">seeds_test</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03389831</span></span>
<span><span class="va">forest2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/online.html">online</a></span><span class="op">(</span><span class="va">forest1</span>, <span class="va">seeds_train</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span>, <span class="va">seeds_train</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest2</span>, <span class="va">seeds_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.forest.online</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">!=</span> <span class="va">seeds_test</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03389831</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bodyfat_train</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tree1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ODT.html">ODT</a></span><span class="op">(</span><span class="va">Density</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">bodyfat_train</span><span class="op">[</span><span class="va">index</span>, <span class="op">]</span>, split <span class="op">=</span> <span class="st">'mse'</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tree1</span>, <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.tree.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred</span> <span class="op">-</span> <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.428549e-05</span></span>
<span><span class="va">tree2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/online.html">online</a></span><span class="op">(</span><span class="va">tree1</span>, <span class="va">bodyfat_train</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bodyfat_train</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tree2</span>, <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.tree.online</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred</span> <span class="op">-</span> <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.418373e-05</span></span></code></pre></div>
<p>prune first judges whether the error of new data is reduced or not if
applied, starting from the last leaf nodes. For ODRF, if argument
‘useOOB=TRUE’ then it uses ‘out-of-bag’ for pruning. Examples are as
follows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">bodyfat_train</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">bodyfat_train</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">3000</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span>,<span class="fl">5</span><span class="op">*</span><span class="fl">200</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">seeds_train</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">seeds_train</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1200</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span>,<span class="fl">5</span><span class="op">*</span><span class="fl">150</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bodyfat_train</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">bodyfat_train</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fl">5</span><span class="op">*</span><span class="fl">200</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">seeds_train</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span>,<span class="fl">8</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">seeds_train</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span>,<span class="fl">8</span><span class="op">]</span>,<span class="fl">5</span><span class="op">*</span><span class="fl">150</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">seeds_train</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">seeds_train</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">forest1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ODRF.html">ODRF</a></span><span class="op">(</span><span class="va">seeds_train</span><span class="op">[</span><span class="va">index</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span>, <span class="va">seeds_train</span><span class="op">[</span><span class="va">index</span>, <span class="fl">8</span><span class="op">]</span>,</span>
<span>  split <span class="op">=</span> <span class="st">"gini"</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest1</span>, <span class="va">seeds_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.forest.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">!=</span> <span class="va">seeds_test</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.06779661</span></span>
<span><span class="va">forest2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">forest1</span>, <span class="va">seeds_train</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span>, <span class="va">seeds_train</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>, <span class="fl">8</span><span class="op">]</span>, </span>
<span>  useOOB <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest2</span>, <span class="va">seeds_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.forest.prune1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">!=</span> <span class="va">seeds_test</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.05084746</span></span>
<span><span class="va">forest3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">forest1</span>, <span class="va">seeds_train</span><span class="op">[</span><span class="va">index</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span>, <span class="va">seeds_train</span><span class="op">[</span><span class="va">index</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest3</span>, <span class="va">seeds_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.forest.prune2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">!=</span> <span class="va">seeds_test</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.06779661</span></span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bodyfat_train</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">bodyfat_train</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tree1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ODT.html">ODT</a></span><span class="op">(</span><span class="va">bodyfat_train</span><span class="op">[</span><span class="va">index</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bodyfat_train</span><span class="op">[</span><span class="va">index</span>, <span class="fl">1</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">'mse'</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tree1</span>, <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.tree.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred</span> <span class="op">-</span> <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 8.18606e-05</span></span>
<span><span class="va">tree2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span><span class="va">tree1</span>, <span class="va">bodyfat_train</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bodyfat_train</span><span class="op">[</span><span class="op">-</span><span class="va">index</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tree2</span>, <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">e.tree.prune</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pred</span> <span class="op">-</span> <span class="va">bodyfat_test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.581808e-05</span></span></code></pre></div>
<p>Note that, prune does not always improve efficiency because the
number of observers in the training set is too small to build a simple
tree structure. Therefore, we expand the training set with random
numbers to make prune effective.</p>
</div>
<div class="section level4">
<h4 id="print-the-tree-structure-of-odt-and-odrf">print the tree structure of ODT and ODRF<a class="anchor" aria-label="anchor" href="#print-the-tree-structure-of-odt-and-odrf"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ODT.html">ODT</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in ODT_compute(formula, Call, varName, X, y, Xsplit, split, lambda, :</span></span>
<span><span class="co">#&gt; You are creating a tree for classification</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============================================================= </span></span>
<span><span class="co">#&gt; Oblique Classification Tree structure </span></span>
<span><span class="co">#&gt; =============================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1) root</span></span>
<span><span class="co">#&gt;    node2)# proj1*X &lt; 0.21 -&gt; (leaf1 = setosa)</span></span>
<span><span class="co">#&gt;    node3)  proj1*X &gt;= 0.21</span></span>
<span><span class="co">#&gt;       node4)# proj2*X &lt; 0.88 -&gt; (leaf2 = versicolor)</span></span>
<span><span class="co">#&gt;       node5)# proj2*X &gt;= 0.88 -&gt; (leaf3 = virginica)</span></span>
<span><span class="va">party.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/partykit/man/party-coercion.html" class="external-link">as.party</a></span><span class="op">(</span><span class="va">tree</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">party.tree</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model formula:</span></span>
<span><span class="co">#&gt; Species ~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fitted party:</span></span>
<span><span class="co">#&gt; [1] root</span></span>
<span><span class="co">#&gt; |   [2] proj1*X &gt;= 0.20707</span></span>
<span><span class="co">#&gt; |   |   [3] proj2*X &gt;= 0.88392: virginica (n = 53, err = 5.7%)</span></span>
<span><span class="co">#&gt; |   |   [4] proj2*X &lt; 0.88392: versicolor (n = 47, err = 0.0%)</span></span>
<span><span class="co">#&gt; |   [5] proj1*X &lt; 0.20707: setosa (n = 50, err = 0.0%)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of inner nodes:    2</span></span>
<span><span class="co">#&gt; Number of terminal nodes: 3</span></span>
<span><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ODRF.html">ODRF</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in ODRF_compute(formula, Call, varName, X, y, split, lambda,</span></span>
<span><span class="co">#&gt; NodeRotateFun, : You are creating a forest for classification</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">forest</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  ODRF.formula(formula = Species ~ ., data = data, parallel = FALSE) </span></span>
<span><span class="co">#&gt;                Type of oblique decision random forest: classification</span></span>
<span><span class="co">#&gt;                                       Number of trees: 100</span></span>
<span><span class="co">#&gt;                            OOB estimate of error rate: 4%</span></span>
<span><span class="co">#&gt; Confusion matrix:</span></span>
<span><span class="co">#&gt;            setosa versicolor virginica class_error</span></span>
<span><span class="co">#&gt; setosa         50          0         0  0.00000000</span></span>
<span><span class="co">#&gt; versicolor      0         47         3  0.05999988</span></span>
<span><span class="co">#&gt; virginica       0          3        47  0.05999988</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-the-tree-structure-of-odt">Plot the tree structure of ODT<a class="anchor" aria-label="anchor" href="#plot-the-tree-structure-of-odt"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></code></pre></div>
<p><img src="Oblique-Decision-Random-Forest_files/figure-html/plot-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<p>If you encounter a clear bug, please file an issue with a minimal
reproducible example on <a href="https://github.com/liuyu-star/ODRF/issues" class="external-link">GitHub</a>.</p>
<hr>
<p>Please note that this project is released with a <a href="https://liuyu-star.github.io/ODRF/CONTRIBUTING" class="external-link">Contributor Code
of Conduct</a>. By participating in this project you agree to abide by
its terms.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yu Liu, Yingcun Xia.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
